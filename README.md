# Проєкт: Безпечна система управління обліковими записами (NestJS)

## Зміст

- [Опис](#опис)
- [Функціональні вимоги](#функціональні-вимоги)
- [Нефункціональні вимоги](#нефункціональні-вимоги)
- [Навігація по проєкту](#навігація-по-проєкту)
- [Postman-колекція та автотести](#postman-колекція-та-автотести)

---

## Опис

Сервіс реалізує базову систему керування обліковими записами користувачів на основі **NestJS** з акцентом на безпеку:
- реєстрація та вхід
- парольна політика
- захист від ботів
- активація акаунта
- обмеження за кількістю невдалих спроб входу
- двофакторна аутентифікація (2FA)
- вхід через сторонні сервіси (OAuth)
- відновлення пароля через e-mail

---

## Функціональні вимоги

### 1. Реєстрація та вхід користувача

- Реалізувати сторінку / ендпоінти для:
  - **реєстрації** нового користувача;
  - **входу** в систему (login).
- Під час реєстрації користувач задає логін (наприклад, e-mail/username) і пароль, що відповідає парольній політиці (див. нижче).
- При вході:
  - спочатку виконується **ідентифікація** користувача за логіном:
    - якщо користувача з таким логіном нема — повернути повідомлення про відсутність в системі та запропонувати перехід до реєстрації;
  - далі виконується **аутентифікація**: перевірка пароля за **рівністю хешів**.

### 2. Політика пароля

Пароль повинен відповідати таким вимогам:

- Мінімальна довжина: **8 символів**.
- Містити **хоча б одну велику** літеру.
- Містити **хоча б одну малу** літеру.
- Містити **хоча б одну цифру**.
- Містити **хоча б один спеціальний символ** (не літера і не цифра).

При реєстрації (та зміні пароля) пароль:
- **не зберігається у відкритому вигляді**;
- хешується за допомогою **захищеного алгоритму хешування паролів** (наприклад, `bcrypt`, `argon2`).

### 3. CAPTCHA при реєстрації

- При реєстрації додати механізм **CAPTCHA** для захисту від ботів.
- CAPTCHA має валідуватися на бекенді перед створенням нового облікового запису.
- У разі невдалої перевірки реєстрація не виконується, повертається помилка.

### 4. Активація облікового запису

- Після реєстрації обліковий запис має статус **«неактивний»**.
- Реалізувати механізм активації акаунта через **електронну пошту**:
  - надсилати користувачу e-mail з **посиланням або токеном активації**;
  - після переходу за посиланням / надсилання токена акаунт стає активним;
  - до активації користувач **не може** виконати повноцінний вхід у систему.

### 5. Обмеження на кількість невдалих спроб входу та логування

- Встановити **ліміт на кількість підряд невдалих спроб входу** (наприклад, N спроб).
- При перевищенні ліміту:
  - тимчасово блокувати акаунт **або** вимагати додаткову перевірку (залежить від обраної логіки).
- Реалізувати **логування спроб входу**, зокрема:
  - дату й час спроби;
  - логін користувача;
  - IP-адресу (за можливості);
  - результат (успіх / невдача, причина).
- Передбачити можливість перегляду цих логів адміністратором (наприклад, окремий ендпоінт або база для аналітики).

### 6. Двофакторна аутентифікація (2FA)

- Додати підтримку **2FA** (механізм на вибір, наприклад:
  - одноразові коди (TOTP через застосунок-генератор типу Google Authenticator);
  - коди через e-mail тощо).
- У профілі користувача реалізувати можливість:
  - **увімкнути 2FA**;
  - **вимкнути 2FA**.
- При ввімкненій 2FA процес входу має включати:
  1. Перевірку логіна/пароля.
  2. Запит та перевірку 2FA-коду.

### 7. Вхід через OAuth (сторонні сервіси)

- Додати можливість входу до системи через **сторонні OAuth-сервіси** (на вибір, наприклад: Google, GitHub, Facebook тощо).
- При вході через OAuth:
  - якщо користувач заходить вперше — створюється обліковий запис, пов’язаний із зовнішнім профілем;
  - при повторних входах — користувач аутентифікується через пов’язаний OAuth-акаунт.

### 8. Відновлення пароля через e-mail

- Реалізувати механізм **відновлення пароля**:
  - ендпоінт / форма «Забули пароль?»;
  - надсилання на e-mail користувача **токена для відновлення** (одноразове посилання).
- Токен відновлення пароля повинен:
  - мати **обмежений термін дії** (наприклад, 15–60 хвилин);
  - бути **одноразовим** (після використання стає недійсним).
- Після переходу за посиланням з e-mail користувач може задати **новий пароль**, що також перевіряється за парольною політикою.

---

## Нефункціональні вимоги

- Сервіс реалізовано на **NestJS** (TypeScript).
- Паролі **ніколи не зберігаються у відкритому вигляді**.
- Використовуються **захищені алгоритми хешування** (bcrypt).
- Конфіденційні налаштування (ключі, секрети, дані для підключення до e-mail та OAuth-провайдерів) зберігаються у змінних оточення (**.env**, не комітяться в репозиторій).
- Логування спроб входу не має розкривати паролі або інші чутливі дані.

---

